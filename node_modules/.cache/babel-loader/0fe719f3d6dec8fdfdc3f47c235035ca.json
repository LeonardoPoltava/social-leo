{"ast":null,"code":"import _regeneratorRuntime from\"/home/vladyslav/projects/react_social_git/social-leo/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vladyslav/projects/react_social_git/social-leo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/vladyslav/projects/react_social_git/social-leo/node_modules/@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{authAPI}from\"../api/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='social-network/auth/SET_USER_DATA';var initialState={userId:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:{return _objectSpread({},state,{},action.payload);}default:{return state;}}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,id,email,login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.auth();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,email=_response$data$data.email,login=_response$data$data.login;dispatch(setAuthUserData(id,email,login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};export var getLoginUserData=function getLoginUserData(login,password,rememberMe){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(login,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}else{message=response.data.messages.length>0?response.data.messages:\"Error\";dispatch(stopSubmit(\"login\",{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};export var getLogoutUserData=function getLogoutUserData(){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());};export default authReducer;","map":{"version":3,"sources":["/home/vladyslav/projects/react_social_git/social-leo/src/redux/auth-reducer.js"],"names":["authAPI","stopSubmit","SET_USER_DATA","initialState","userId","email","login","isAuth","authReducer","state","action","type","payload","setAuthUserData","getAuthUserData","dispatch","auth","response","data","resultCode","id","getLoginUserData","password","rememberMe","message","messages","length","_error","getLogoutUserData","logout"],"mappings":"gqCAAA,OAAQA,OAAR,KAAsB,YAAtB,CACA,OAAQC,UAAR,KAAyB,YAAzB,CAEA,GAAMC,CAAAA,aAAa,CAAG,mCAAtB,CAEA,GAAIC,CAAAA,YAAY,CAAG,CACfC,MAAM,CAAE,IADO,CAEfC,KAAK,CAAE,IAFQ,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAClD,OAAOA,MAAM,CAACC,IAAd,EACI,IAAKT,CAAAA,aAAL,CAAoB,CAChB,wBACOO,KADP,IAEOC,MAAM,CAACE,OAFd,EAIH,CACD,QAAS,CACL,MAAOH,CAAAA,KAAP,CACH,CATL,CAWH,CAZD,CAcA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAAmC,CAACI,IAAI,CAAET,aAAP,CAAsBU,OAAO,CAAE,CAACR,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAAuBC,MAAM,CAANA,MAAvB,CAA/B,CAAnC,EAAxB,CACP,MAAO,IAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,mGAAM,iBAAOC,QAAP,wLACZf,CAAAA,OAAO,CAACgB,IAAR,EADY,QAC7BC,QAD6B,eAGjC,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAmC,qBACNF,QAAQ,CAACC,IAAT,CAAcA,IADR,CAC1BE,EAD0B,qBAC1BA,EAD0B,CACtBf,KADsB,qBACtBA,KADsB,CACfC,KADe,qBACfA,KADe,CAE/BS,QAAQ,CAACF,eAAe,CAACO,EAAD,CAAKf,KAAL,CAAYC,KAAZ,CAAmB,IAAnB,CAAhB,CAAR,CACH,CANgC,sDAAN,iEAAxB,CASP,MAAO,IAAMe,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACf,KAAD,CAAQgB,QAAR,CAAkBC,UAAlB,mGAAiC,kBAAOR,QAAP,kKACxCf,CAAAA,OAAO,CAACM,KAAR,CAAcA,KAAd,CAAqBgB,QAArB,CAA+BC,UAA/B,CADwC,QACzDN,QADyD,gBAG7D,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAmC,CAC/BJ,QAAQ,CAACD,eAAe,EAAhB,CAAR,CACH,CAFD,IAGK,CACGU,OADH,CACaP,QAAQ,CAACC,IAAT,CAAcO,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCT,QAAQ,CAACC,IAAT,CAAcO,QAAlD,CAA6D,OAD1E,CAEDV,QAAQ,CAACd,UAAU,CAAC,OAAD,CAAU,CAAC0B,MAAM,CAAEH,OAAT,CAAV,CAAX,CAAR,CACH,CAT4D,wDAAjC,mEAAzB,CAWP,MAAO,IAAMI,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,oGAAM,kBAAOb,QAAP,0JACdf,CAAAA,OAAO,CAAC6B,MAAR,EADc,QAC/BZ,QAD+B,gBAGnC,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAmC,CAC/BJ,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CACH,CALkC,wDAAN,mEAA1B,CAQP,cAAeL,CAAAA,WAAf","sourcesContent":["import {authAPI} from \"../api/api\";\nimport {stopSubmit} from \"redux-form\";\n\nconst SET_USER_DATA = 'social-network/auth/SET_USER_DATA';\n\nlet initialState = {\n    userId: null,\n    email: null,\n    login: null,\n    isAuth: false\n};\n\nconst authReducer = (state = initialState, action) => {\n    switch(action.type){\n        case SET_USER_DATA: {\n            return {\n                ...state,\n                ...action.payload\n            }\n        }\n        default: {\n            return state;\n        }\n    }\n};\n\nexport const setAuthUserData = (userId, email, login, isAuth) => ({type: SET_USER_DATA, payload: {userId, email, login, isAuth}});\nexport const getAuthUserData = () => async (dispatch) => {\n    let response = await authAPI.auth();\n\n    if(response.data.resultCode === 0) {\n        let {id, email, login} = response.data.data;\n        dispatch(setAuthUserData(id, email, login, true));\n    }\n}\n\nexport const getLoginUserData = (login, password, rememberMe) => async (dispatch) => {\n    let response = await authAPI.login(login, password, rememberMe);\n\n    if(response.data.resultCode === 0) {\n        dispatch(getAuthUserData());\n    }\n    else {\n        let message = response.data.messages.length > 0 ? response.data.messages : \"Error\";\n        dispatch(stopSubmit(\"login\", {_error: message}));\n    }\n};\nexport const getLogoutUserData = () => async (dispatch) => {\n    let response = await authAPI.logout();\n\n    if(response.data.resultCode === 0) {\n        dispatch(setAuthUserData(null, null, null, false));\n    }\n}\n\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}